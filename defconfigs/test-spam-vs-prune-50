#
# Test AdamWSPAM (2 pruning methods) vs AdamWPrune at 50% sparsity
# Will run exactly 3 tests:
#   1. AdamWSPAM + magnitude pruning @ 50%
#   2. AdamWSPAM + movement pruning @ 50%
#   3. AdamWPrune (AdamWSPAM base) + state pruning @ 50%
#

# Model Selection - Use LeNet-5 for quick testing
CONFIG_MODEL_MODE_SINGLE=y
CONFIG_MODEL_SELECT_LENET5=y

# Enable test matrix mode
CONFIG_TEST_MATRIX_MODE=y

# Optimizer Configuration - Test AdamWSPAM and AdamWPrune
CONFIG_OPTIMIZER_MODE_MULTIPLE=y
CONFIG_OPTIMIZER_ENABLE_ADAMWSPAM=y
CONFIG_OPTIMIZER_ENABLE_ADAMWPRUNE=y
CONFIG_TEST_OPTIMIZER_ENABLED_ADAMWSPAM=y
CONFIG_TEST_OPTIMIZER_ENABLED_ADAMWPRUNE=y
# Disable all other optimizers
CONFIG_OPTIMIZER_ENABLE_SGD=n
CONFIG_OPTIMIZER_ENABLE_ADAM=n
CONFIG_OPTIMIZER_ENABLE_ADAMW=n
CONFIG_OPTIMIZER_ENABLE_ADAMWADV=n

# AdamWPrune settings
CONFIG_ADAMWPRUNE_BASE_ADAMWSPAM=y
CONFIG_ADAMWPRUNE_ENABLE_PRUNING=y
CONFIG_ADAMWPRUNE_TARGET_SPARSITY="0.5"

# SPAM settings (both optimizers use these)
CONFIG_SPAM_ENABLE_CLIP=y
CONFIG_SPAM_SPIKE_THRESHOLD="2.0"
CONFIG_SPAM_THETA="50.0"

# Pruning - Multiple methods for testing
CONFIG_PRUNING_MODE_MULTIPLE=y
CONFIG_PRUNING_ENABLE_MAGNITUDE=y
CONFIG_PRUNING_ENABLE_MOVEMENT=y
CONFIG_PRUNING_ENABLE_STATE=y
CONFIG_PRUNING_ENABLE_NONE=n
CONFIG_PRUNING_ENABLED_MAGNITUDE=y
CONFIG_PRUNING_ENABLED_MOVEMENT=y
CONFIG_PRUNING_ENABLED_STATE=y
CONFIG_TEST_PRUNING_MAGNITUDE=y
CONFIG_TEST_PRUNING_MOVEMENT=y
CONFIG_TEST_PRUNING_NONE=n
CONFIG_TEST_PRUNING_METHODS="magnitude,movement"

# Only test 50% sparsity
CONFIG_TARGET_SPARSITY="0.5"
CONFIG_SPARSITY_ENABLE_50=y
CONFIG_SPARSITY_ENABLE_70=n
CONFIG_SPARSITY_ENABLE_90=n
CONFIG_TEST_SPARSITY_50=y
CONFIG_TEST_SPARSITY_70=n
CONFIG_TEST_SPARSITY_90=n

# Training settings
CONFIG_BATCH_SIZE=128
CONFIG_NUM_EPOCHS=5
CONFIG_LEARNING_RATE="0.001"