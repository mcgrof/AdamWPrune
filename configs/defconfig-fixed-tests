# Configuration for testing the fixed issues
# This config tests both the failed AdamWPrune state pruning and
# the movement pruning that was overshooting sparsity

# Model to test
CONFIG_MODEL_GPT2=y

# Base optimizers to test
CONFIG_OPTIMIZER_ADAMWSPAM=y
CONFIG_OPTIMIZER_ADAMWPRUNE=y

# Pruning methods to test
CONFIG_PRUNING_MOVEMENT=y  # Test the movement pruning frequency fix
CONFIG_PRUNING_STATE=y     # Test the AdamWPrune iteration-based training fix

# Sparsity levels to test
CONFIG_SPARSITY_50=y

# Default training parameters for GPT-2
CONFIG_GPT2_BATCH_SIZE=32
CONFIG_GPT2_GRADIENT_ACCUMULATION=4
CONFIG_GPT2_WARMUP_STEPS=2000
CONFIG_GPT2_EVAL_INTERVAL=500
CONFIG_GPT2_LEARNING_RATE=6e-4
CONFIG_GPT2_MIN_LR=6e-5
CONFIG_GPT2_WEIGHT_DECAY=0.1

# Pruning warmup for movement/magnitude pruning
CONFIG_PRUNING_WARMUP=100

# AdamWPrune specific parameters
CONFIG_ADAMWPRUNE_WARMUP_STEPS=100
CONFIG_ADAMWPRUNE_FREQUENCY=50

# AdamWSPAM parameters
CONFIG_SPAM_THETA=50.0
CONFIG_SPAM_INTERVAL=1000
CONFIG_SPAM_WARMUP_STEPS=1000
CONFIG_SPAM_ENABLE_CLIP=y

# Test configuration
CONFIG_TEST_PARALLEL_JOBS=1
CONFIG_TRACKER="wandb,trackio"
CONFIG_TRACKER_PROJECT="tracking-e97b5"